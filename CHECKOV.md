## Checkov

We use [checkov](https://www.checkov.io/) by bridgecrew to scan the code to validate our modules security and compliance best practices.

## Approach

* This repository contains our modules, we are scanning the IaC code with checkov for compliance and security.
* We have created for each module a sub-folder which contains one or more examples of module usage.
* Validation testing and security scan happens using the example code.
* We are using one of our AWS accounts with a default vpc which contains public subnets only (todo: add a proper VPC).
* The examples are for demostration purposes only, use them at your discretion, we strongly recommend to modify them to fit your purpose and Compliance requirements.

## Config

We are using the file `.checkov.yml` for standard configuration and checks we have chosen to skip.

If we must change the default configuration of Checkov we will place it on the `.checkov.yml` folder of each module.

Some modules might not have a `.checkov.yml` because the default checkov configuration is ok.

## Skipping checkov checks

We will document skipped codes on the module `README.md` and add a `.checkov.yml` file with the code(s) list(s).

By and large we don't want to skip checks, but on the situations we will some of our rationale is:

* We are using the default VPC for testing which only has public ip's, this is by design and will trigger `FAILED` checks.

* Some examples we find valuable by design and will "trip" checkov but are not MAJOR issues.

* The team wants to ignore the flagged check from a design and/or cost perspective, we will add the reasoning on the `README.md` of the module.

## Usage:

We are not scanning the module itself, instead we scan the plan generated by the example, this means that if you use the module in a different configuration new alerts can surface, always scan your code.

See below command examples:

## Generating a configuration with skips
```console
$ checkov -f . --skip-check CKV_AWS_129 --create-config ./config.yml
```

## Executing the scan

### MacOs/Linux
```console
$ terraform init \
    && terraform plan --out tfplan.bin \
    && terraform show tfplan.bin -json > tfplan.json \
    && checkov -f tfplan.json 
```

### Windows Poweshell
```console
$ terraform init `
    && terraform plan --out tfplan.bin `
    && terraform show tfplan.bin -json > tfplan.json `
    && checkov -f tfplan.json
```









###### The Boldlink-SIG Team - 2022

